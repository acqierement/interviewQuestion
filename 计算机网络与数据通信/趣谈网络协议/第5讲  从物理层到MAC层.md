# 第5讲 | 从物理层到MAC层

## 物理层

物理层就包括网线之类的。还有交换集线器（Hub）也是网桥的一种，hub中的每个端口都能提供类似网桥的功能。

## 数据链路层

数据链路层也叫做MAC层，因为该层有MAC地址，理论上是全球唯一的地址，但是这其实 不是绝对的。MAC的全称是Medium Access Control，即媒体访问控制。解决谁先发，谁后发的问题，学名叫多路访问。通常有三种方法

- 信道划分，分成几个信道，你走你的，我走我的。
- 轮流协议，今天单号出行，明天双号出行，轮流来。
- 随机接入协议，以太网就是使用这个方法。不管什么情况，有事先出门，路上太堵了再回来，等会再出去。

如果不知道MAC地址，就需要使用ARP（Address Resolution Protocol）——地址解析协议。ARP其实就是通过IP地址，找到对应IP地址的MAC地址。发送一个广播包，所有的机器都收到了，对应ip地址的那个机器就将MAC地址填入这个数据包，然后再返回原来的地方。

这样，当你只知道IP地址的时候，想要知道MAC地址的时候都需要发送一个广播包，这样会造成网络流量浪费。所以就可以建立一个ARP缓存，由于IP地址变化比较频繁，所以这个ARP缓存的生命周期也不长。

## 局域网

局域网中电脑比较多，这时候需要一个交换机。这里我们指的就是二层设备，也可以叫做网桥。交换机需要有自学功能，可以记住接口1的数据是连接接口2的。当接口1第一次来的时候，交换机并不知道要发到哪个接口，所以他给所有的出口发送了数据，其中接口2得到了回复，交换机就记录下了接口1连接接口2。把这个结果记录到转发表上，下次遇到问题就不需要广播了。